---
// src/pages/faq.astro
import Layout from "../layouts/Layout.astro";
import { getCollection, type CollectionEntry } from "astro:content";

const entries = (await getCollection("faqs")) as CollectionEntry<"faqs">[];

const faqs = entries
  .sort((a, b) => (a.data.sort ?? 9999) - (b.data.sort ?? 9999))
  .map((e) => e.data);

const faqJsonLd = {
  "@context": "https://schema.org",
  "@type": "FAQPage",
  "mainEntity": faqs.map(({ q, a }) => ({
    "@type": "Question",
    "name": q,
    "acceptedAnswer": { "@type": "Answer", "text": a }
  }))
};
---

<Layout title="BluTattoo Studio â€” FAQ">

  <article class="page-article page-article--stack space-y-6">
    <h1 class="page-title">FAQ</h1>

    <div class="divide-y divide-black/10 border border-black/10">
      {faqs.map(({ q, a }) => (
        <details class="group open:bg-black/5">
          <summary class="flex cursor-pointer items-center justify-between gap-4 p-4 font-medium hover:bg-black/5">
            <span>{q}</span>
            <svg viewBox="0 0 24 24" class="h-5 w-5 shrink-0 transition-transform group-open:rotate-180" aria-hidden="true">
              <path d="M7 10l5 5 5-5H7z" />
            </svg>
          </summary>

          <div class="px-4 pb-4">
            <p class="leading-relaxed">{a}</p>
          </div>
        </details>
      ))}
    </div>

    <p class="mt-6 text-sm">
      Still have questions? <a href="/contact" class="underline hover:no-underline">Contact us</a> or see
      our <a href="/aftercare" class="underline hover:no-underline">Aftercare</a> guide.
    </p>
  </article>


  {/* SEO: FAQPage structured data */}
  <script type="application/ld+json">
    {JSON.stringify(faqJsonLd)}
  </script>


</Layout>
